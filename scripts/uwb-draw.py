import re
import matplotlib.pyplot as plt

# Replace this string with your UWB data or load from a file
raw_data1    = """
[21:35:07.143892] 1 -> 0: -1.33
[21:35:07.363053] 1 -> 0: -0.58
[21:35:07.378884] 1 -> 0: -0.76
[21:35:07.393900] 0 -> 1: 0.73
[21:35:07.395534] 1 -> 0: -0.78
[21:35:07.478090] 0 -> 1: 0.73
[21:35:07.494797] 0 -> 1: 0.89
[21:35:07.513527] 1 -> 0: -0.79
[21:35:07.530834] 1 -> 0: -0.68
[21:35:07.544906] 0 -> 1: 0.76
[21:35:07.547669] 1 -> 0: -0.69
[21:35:07.562107] 0 -> 1: 0.69
[21:35:07.563512] 1 -> 0: -0.80
[21:35:07.579008] 0 -> 1: 0.71
[21:35:07.580489] 1 -> 0: -0.73
[21:35:07.595959] 0 -> 1: 0.74
[21:35:08.168482] 0 -> 1: 0.62
[21:35:08.183801] 0 -> 1: 0.55
[21:35:08.285086] 0 -> 1: 0.81
[21:35:08.335035] 0 -> 1: 0.57
[21:35:08.351894] 0 -> 1: 0.56
[21:35:08.404053] 1 -> 0: -1.24
[21:35:08.420945] 1 -> 0: -5.59
[21:35:08.757037] 1 -> 0: -1.22
[21:35:08.771831] 0 -> 1: 0.74
[21:35:08.841052] 1 -> 0: -1.23
[21:35:08.857821] 1 -> 0: -5.58
[21:35:09.194221] 1 -> 0: -1.41
[21:35:09.211991] 1 -> 0: -1.23
[21:35:09.245135] 1 -> 0: -1.25
[21:35:09.311909] 1 -> 0: -1.27
[21:35:09.329029] 1 -> 0: -5.62
[21:35:09.413095] 1 -> 0: -1.25
[21:35:09.427027] 0 -> 1: 0.73
[21:35:09.443897] 0 -> 1: 0.65
[21:35:09.446645] 1 -> 0: -1.14
[21:35:09.461058] 0 -> 1: 0.71
[21:35:09.462557] 1 -> 0: -1.36
[21:35:09.631329] 1 -> 0: -1.34
[21:35:09.647930] 1 -> 0: -5.50
[21:35:09.782180] 1 -> 0: -1.29
[21:35:09.799123] 1 -> 0: -1.25
[21:35:10.069842] 1 -> 0: -1.31
[21:35:10.086495] 1 -> 0: -1.26
[21:35:10.101458] 1 -> 0: -0.72
[21:35:10.186104] 1 -> 0: -1.37
[21:35:10.202921] 1 -> 0: -0.84
[21:35:10.387007] 1 -> 0: -1.29
[21:35:10.403922] 1 -> 0: -1.21
[21:35:10.421113] 1 -> 0: -5.44
"""

raw_data2 ="""
[20:00:06.292724] 0 -> 1: -1.57
[20:00:06.309475] 0 -> 1: -1.55
[20:00:07.017507] 1 -> 0: 1.10
[20:00:07.048670] 0 -> 1: -1.29
[20:00:07.065489] 0 -> 1: -1.34
[20:00:07.099343] 0 -> 1: -1.40
[20:00:07.115785] 0 -> 1: -1.25
[20:00:07.134651] 1 -> 0: 0.99
[20:00:07.149514] 0 -> 1: -1.38
[20:00:07.991792] 1 -> 0: 1.03
[20:00:08.006413] 0 -> 1: -1.40
[20:00:08.023433] 0 -> 1: -1.41
[20:00:08.073741] 0 -> 1: -1.44
[20:00:08.090809] 0 -> 1: -1.42
[20:00:08.712290] 0 -> 1: -1.24
[20:00:08.732654] 0 -> 1: -1.44
[20:00:09.403456] 1 -> 0: 0.72
[20:00:09.418094] 0 -> 1: -1.20
[20:00:09.434711] 0 -> 1: -1.26
[20:00:11.621231] 1 -> 0: 1.09
[20:00:11.636060] 0 -> 1: -1.34
[20:00:11.654740] 1 -> 0: 1.11
[20:00:11.671414] 1 -> 0: 1.14
[20:00:11.722193] 1 -> 0: 1.17
[20:00:11.736956] 0 -> 1: -1.32
[20:00:11.738767] 1 -> 0: 1.15
[20:00:11.753743] 0 -> 1: -1.43
[20:00:11.755428] 1 -> 0: 1.07
[20:00:11.770296] 0 -> 1: -1.40
[20:00:11.938529] 0 -> 1: -1.32
[20:00:11.955261] 0 -> 1: -1.32
[20:00:11.974046] 1 -> 0: 0.95
[20:00:11.988900] 0 -> 1: -1.31
[20:00:12.091707] 1 -> 0: 1.14
[20:00:12.124206] 0 -> 1: -1.27
[20:00:12.158978] 1 -> 0: 1.06
[20:00:12.879632] 0 -> 1: -1.40
[20:00:13.064282] 0 -> 1: -1.29
[20:00:13.081192] 0 -> 1: -1.25
[20:00:13.150338] 1 -> 0: 1.22
[20:00:16.275901] 1 -> 0: 1.03
[20:00:17.754645] 1 -> 0: 1.18
[20:00:17.788198] 1 -> 0: 0.87
[20:00:18.324042] 0 -> 1: -1.42
20:00:19.164391] 0 -> 1: -1.33
[20:00:47.715998] 1 -> 0: 0.83
[20:00:47.732706] 1 -> 0: 0.80
[20:00:47.951160] 1 -> 0: 2.33
[20:00:48.304643] 1 -> 0: 0.90
[20:00:50.556608] 1 -> 0: 0.94
"""

def parse_trace(raw_data):
    pattern = re.compile(r"\[\d+:\d+:\d+\.\d+]\s+(\d)\s+->\s+(\d):\s+(-?\d+\.\d+)")
    values = []
    for match in pattern.finditer(raw_data):
        src, dst, val = match.groups()
        value = float(val)
        if src == '1' and dst == '0':
            value = -value
        values.append(value)
    return values

values1 = parse_trace(raw_data1)
values2 = parse_trace(raw_data2)

# Plot both traces
plt.plot(values1, marker='o', label="Trace 1")
plt.plot(values2, marker='x', label="Trace 2")
plt.xlabel("Sample Index")
plt.ylabel("Distance(0 - 1) [m]")
plt.title("UWB Distance Difference Comparison")
plt.grid(True)
plt.legend()
plt.tight_layout()
plt.show()